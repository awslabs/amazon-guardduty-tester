{
    "definitions": [
        {
            "resource": "ec2",
            "tactic": "backdoor",
            "findingType": "Backdoor:EC2/C&CActivity.B!DNS",
            "alias": "threatIntel/request.sh",
            "indicator": "c2.guarddutyc2activityb.com",
            "logSource": "dns",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - C&C Activity DNS\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": C&C Activity DNS\" \"Expected Finding: EC2 instance \"$LINUX_INSTANCE\" is querying a domain name associated with a known Command & Control server.\" \"Finding Type : Backdoor:EC2/C&CActivity.B!DNS\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "backdoor",
            "findingType": "Backdoor:EC2/DenialOfService.UDP",
            "alias": "ec2/DenialOfService-UDP.sh",
            "logSource": "vpc-flowlogs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Denial Of Service UDP\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": Denial Of Service UDP\" \"Expected Finding: EC2 instance \"$RED_TEAM_INSTANCE\" is behaving in a manner that may indicate it is being used to perform a Denial of Service (DoS) attack using UDP protocol.\" \"Finding Type : Backdoor:EC2/DenialOfService.UDP\" \"\"",
            "port": "80"
        },
        {
            "resource": "ec2",
            "tactic": "backdoor",
            "findingType": "Backdoor:EC2/DenialOfService.DNS",
            "alias": "ec2/DenialOfService-DNS.sh",
            "logSource": "vpc-flowlogs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Denial Of Service DNS\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": Denial Of Service DNS\" \"Expected Finding: EC2 instance \"$RED_TEAM_INSTANCE\" is behaving in a manner that may indicate it is being used to perform a Denial of Service (DoS) attack using DNS protocol.\" \"Finding Type : Backdoor:EC2/DenialOfService.DNS\" \"\"",
            "port": "53"
        },
        {
            "resource": "ec2",
            "tactic": "crypto",
            "findingType": "CryptoCurrency:EC2/BitcoinTool.B!DNS",
            "alias": "threatIntel/request.sh",
            "indicator": "crypto.guarddutyc2activityb.com",
            "logSource": "dns",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - CryptoCurrency Mining Activity DNS\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": CryptoCurrency Mining Activity DNS\" \"Expected Finding: EC2 instance \"$LINUX_INSTANCE\" is querying a domain name that is associated with bitcoin activity.\" \"Finding Type : CryptoCurrency:EC2/BitcoinTool.B!DNS\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "impact",
            "findingType": "Impact:EC2/AbusedDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "indicator": "abused-rep.guarddutyc2activityb.com",
            "logSource": "dns",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Abused Domain Reputation\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": Abused Domain Reputation\" \"Expected Finding: EC2 instance \"$LINUX_INSTANCE\" is querying a low reputation domain that is associated with known abused domains.\" \"Finding Type : Impact:EC2/AbusedDomainRequest.Reputation\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "impact",
            "findingType": "Impact:EC2/BitcoinDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "indicator": "crypto-rep.guarddutyc2activityb.com",
            "logSource": "dns",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Bitcoin Domain Reputation\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": Bitcoin Domain Reputation\" \"Expected Finding: EC2 instance \"$LINUX_INSTANCE\" is querying a low reputation domain that is associated with cryptocurrency-related activity.\" \"Finding Type : Impact:EC2/BitcoinDomainRequest.Reputation\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "impact",
            "findingType": "Impact:EC2/MaliciousDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "indicator": "malicious-rep.guarddutyc2activityb.com",
            "logSource": "dns",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Malicious Domain Reputation\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": Malicious Domain Reputation\" \"Expected Finding: EC2 instance \"$LINUX_INSTANCE\" is querying a low reputation domain that is associated with malicious activity.\" \"Finding Type : Impact:EC2/MaliciousDomainRequest.Reputation\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "impact",
            "findingType": "Impact:EC2/SuspiciousDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "indicator": "suspicious-rep.guarddutyc2activityb.com",
            "logSource": "dns",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Suspicious Domain Reputation\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": Suspicious Domain Reputation\" \"Expected Finding: EC2 instance \"$LINUX_INSTANCE\" is querying a low reputation domain that is suspicious in nature due to its age, low popularity, or similarity to other known malicious domains.\" \"Finding Type : Impact:EC2/SuspiciousDomainRequest.Reputation\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "recon",
            "findingType": "Recon:EC2/Portscan",
            "alias": "ec2/Portscan.sh",
            "logSource": "vpc-flowlogs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Internal port scanning\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": Internal Port Scanning\" \"Expected Finding: EC2 Instance \"$RED_TEAM_INSTANCE\" is performing outbound port scans against remote host. $LINUX_IP\" \"Finding Type: Recon:EC2/Portscan\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "trojan",
            "findingType": "Trojan:EC2/DropPoint!DNS",
            "alias": "threatIntel/request.sh",
            "indicator": "guarddutydroppointactivity.com",
            "logSource": "dns",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - DropPoint DNS\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": DropPointDNS\" \"Expected Finding: EC2 instance \"$LINUX_INSTANCE\" is querying a domain name of a remote host that is known to hold credentials and other stolen data captured by malware.\" \"Finding Type : Trojan:EC2/DropPoint!DNS\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "trojan",
            "findingType": "Trojan:EC2/DNSDataExfiltration",
            "alias": "ec2/DNSDataExfiltration.sh",
            "logSource": "vpc-flowlogs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - DNS Exfiltration\"",
            "expectedFinding": "\"Test #$TEST_NUM: DNS Exfiltration\" \"Expected Finding: EC2 instance $RED_TEAM_INSTANCE is attempting to query domain names that resemble exfiltrated data.\" \"Finding Type : Trojan:EC2/DNSDataExfiltration \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "trojan",
            "findingType": "Trojan:EC2/BlackholeTraffic!DNS",
            "alias": "threatIntel/request.sh",
            "indicator": "guarddutyblackholeactivity.com",
            "logSource": "dns",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - BlackholeTraffic DNS\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": BlackholeTraffic DNS\" \"Expected Finding: EC2 instance \"$LINUX_INSTANCE\" is querying a domain name of a remote host that is being redirected to a black hole IP address.\" \"Finding Type : Trojan:EC2/BlackholeTraffic!DNS\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "trojan",
            "findingType": "Trojan:EC2/PhishingDomainRequest!DNS",
            "alias": "threatIntel/request.sh",
            "indicator": "guarddutyphishingactivity.com",
            "logSource": "dns",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Phishing Domain\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": Phishing Domain Request\" \"Expected Finding: EC2 instance \"$LINUX_INSTANCE\" is querying a domain involved in phishing attacks.\" \"Finding Type : Trojan:EC2/PhishingDomainRequest!DNS \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "trojan",
            "findingType": "Trojan:EC2/DriveBySourceTraffic!DNS",
            "alias": "threatIntel/request.sh",
            "indicator": "guarddutydrivebyactivity.com",
            "logSource": "dns",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Drive By Domain\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": Drive By Domain Request\" \"Expected Finding: EC2 instance \"$LINUX_INSTANCE\" is querying a domain involved in known drive-by download attacks.\" \"Finding Type : Trojan:EC2/DriveBySourceTraffic!DNS \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "trojan",
            "findingType": "Trojan:EC2/DGADomainRequest.C!DNS",
            "alias": "threatIntel/request.sh",
            "indicator": "guarddutydgaactivity.com",
            "logSource": "dns",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - DGA Request\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": DGA Request\" \"Expected Finding: EC2 instance \"$LINUX_INSTANCE\" is querying algorithmically generated domains. Such domains are commonly used by malware and could be an indication of a compromised EC2 instance.\" \"Finding Type : Trojan:EC2/DGADomainRequest.C!DNS \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:EC2/SSHBruteForce",
            "alias": "ec2/SSHBruteForce.sh",
            "logSource": "vpc-flowlogs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - SSH Brute Force with Compromised Keys\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": SSH Brute Force with Compromised Keys\" \"Expecting two findings - one for the outbound and one for the inbound detection\" \"Outbound: \"$RED_TEAM_INSTANCE\" is performing SSH brute force attacks against \"$LINUX_IP\"\" \"Inbound: \"$RED_TEAM_IP\" is performing SSH brute force attacks against \"$LINUX_INSTANCE\"\" \"Finding Type: UnauthorizedAccess:EC2/SSHBruteForce\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:EC2/RDPBruteForce",
            "alias": "ec2/RDPBruteForce.sh",
            "logSource": "vpc-flowlogs",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - RDP Brute Force with Password List\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": RDP Brute Force with Password List\" \"Expecting two findings - one for the outbound and one for the inbound detection\" \"Outbound: \"$RED_TEAM_INSTANCE\" is performing RDP brute force attacks against \"$WINDOWS_IP\"\" \"Inbound: \"$RED_TEAM_IP\" is performing RDP brute force attacks against \"$WINDOWS_INSTANCE\"\" \"Finding Type : UnauthorizedAccess:EC2/RDPBruteForce\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:EC2/MaliciousIPCaller.Custom",
            "alias": "threatIntel/request.sh",
            "indicator": "",
            "logSource": "vpc-flowlogs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Malicious IP Caller\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": Malicious IP Caller\" \"Expected Finding: EC2 instance \"$RED_TEAM_INSTANCE\" is communicating with an IP address included on a threat list that you uploaded\" \"Finding Type : UnauthorizedAccess:EC2/MaliciousIPCaller.Custom \" \"\"",
            "port": "8009"
        },
        {
            "resource": "ec2",
            "tactic": "backdoor",
            "findingType": "Backdoor:Runtime/C&CActivity.B!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "indicator": "c2.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - C&C Activity\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": EC2 C&C Activity\" \"Expected Finding: A process is querying a domain name associated with a known Command & Control server.\" \"Finding Type : Backdoor:Runtime/C&CActivity.B!DNS\" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "crypto",
            "findingType": "CryptoCurrency:Runtime/BitcoinTool.B!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "indicator": "crypto.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - Bitcoin Domain\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": EC2 Bitcoin Tool DNS\" \"Expected Finding: Process curl from EC2 instance \"$RED_TEAM_INSTANCE\" is querying a domain name that is associated with Bitcoin-related activity.\" \"Finding Type : CryptoCurrency:Runtime/BitcoinTool.B!DNS \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "defense-evasion",
            "findingType": "DefenseEvasion:Runtime/ProcessInjection.Ptrace",
            "alias": "runtime/ProcessInjection-Ptrace.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Process Injection Ptrace\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 Process Injection Proc\" \"Expected Finding: Process in EC2 instance $RED_TEAM_INSTANCE  has attempted to inject code in process using PTRACE\" \"Finding Type : DefenseEvasion:Runtime/ProcessInjection.Ptrace \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "defense-evasion",
            "findingType": "DefenseEvasion:Runtime/ProcessInjection.VirtualMemoryWrite",
            "alias": "runtime/ProcessInjection-VirtualMemoryWrite.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Process Injection Virtual Memory Write\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 Process Injection VMW\" \"Expected Finding: Process in EC2 instance $RED_TEAM_INSTANCE  has attempted to inject code in process using PROCESS_VM_WRITE\" \"Finding Type : DefenseEvasion:Runtime/ProcessInjection.VirtualMemoryWrite \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "impact",
            "findingType": "Impact:Runtime/AbusedDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "indicator": "abused-rep.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - Abused Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 Abused Domain Reputation\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a low reputation domain that is associated with known abused domains\" \"Finding Type : Impact:Runtime/AbusedDomainRequest.Reputation \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "impact",
            "findingType": "Impact:Runtime/BitcoinDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "indicator": "crypto-rep.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - Bitcoin Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 Bitcoin Domain Reputation\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a low reputation and is associated with bitcoin mining domains\" \"Finding Type : Impact:Runtime/BitcoinDomainRequest.Reputation \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "impact",
            "findingType": "Impact:Runtime/MaliciousDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "indicator": "malicious-rep.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - Malicious Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 Malicious Domain Reputation\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a low reputation domain that is associated with malicious activity\" \"Finding Type : Impact:Runtime/MaliciousDomainRequest.Reputation \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "impact",
            "findingType": "Impact:Runtime/SuspiciousDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "indicator": "suspicious-rep.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - Suspicious Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 Suspicious Domain Reputation\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a low reputation domain that is suspicious in nature due to its age, low popularity, or similarity to other known malicious domains.\" \"Finding Type : Impact:Runtime/SuspiciousDomainRequest.Reputation \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/BlackholeTraffic!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "indicator": "guarddutyblackholeactivity.com",
            "description": "echo \"Test #$TEST_NUM - BlackholeTraffic Attack\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 BlackholeTraffic DNS\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a blackholed domain name\" \"Finding Type : Trojan:Runtime/BlackholeTraffic!DNS \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/DGADomainRequest.C!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "indicator": "guarddutydgaactivity.com",
            "description": "echo \"Test #$TEST_NUM - DGA Domain Request\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 DGA Domain Request\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying algorithmically generated domains. Such domains are commonly used by malware and could be an indication of a compromised EC2 instance.\" \"Finding Type : Trojan:Runtime/DGADomainRequest.C!DNS \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/DriveBySourceTraffic!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "indicator": "guarddutydrivebyactivity.com",
            "description": "echo \"Test #$TEST_NUM - DGA Request\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 DGA\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying algorithmically generated domains. Such domains are commonly used by malware and could be an indication of a compromised EC2 instance.\" \"Finding Type : Trojan:Runtime/DGADomainRequest.C!DNS \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/DropPoint!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "indicator": "guarddutydroppointactivity.com",
            "description": "echo \"Test #$TEST_NUM - DropPoint DNS\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 DropPoint DNS\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a domain name of a remote host that is known to hold credentials and other stolen data captured by malware.\" \"Finding Type : Trojan:Runtime/DropPoint!DNS \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/PhishingDomainRequest!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "indicator": "guarddutyphishingactivity.com",
            "description": "echo \"Test #$TEST_NUM - Phishing Domain\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 Phishing Domain Request\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE has attempted to communicate with a domain name associated with phishing activities.\" \"Finding Type : Trojan:Runtime/PhishingDomainRequest!DNS \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:Runtime/MaliciousIPCaller.Custom",
            "alias": "threatIntel/request.sh",
            "indicator": "",
            "logSource": "runtime-monitoring",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Malicious IP Caller\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 Malicious IP Caller\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is communicating with an IP address $MALICIOUS_IP on your threat list\" \"Finding Type : UnauthorizedAccess:Runtime/MaliciousIPCaller.Custom \" \"\"",
            "port": "8009"
        },
        {
            "resource": "ec2",
            "tactic": "execution",
            "findingType": "Execution:Runtime/ReverseShell",
            "alias": "runtime/ReverseShell.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Reverse Shell\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 Reverse Shell\" \"Expected Finding: Process in EC2 instance $RED_TEAM_INSTANCE has created a reverse shell\" \"Finding Type : Execution:Runtime/ReverseShell \" \"\""
        },
        {
            "resource": "ec2",
            "tactic": "execution",
            "findingType": "Execution:Runtime/MemoryMarkedExecutable",
            "alias": "runtime/MemoryMarkedExecutable.sh",
            "logSource": "runtime-monitoring",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Memory Marked Executable\"",
            "expectedFinding": "\"Test #$TEST_NUM: EC2 Memory Marked Executable\" \"Expected Finding: Process in EC2 instance $RED_TEAM_INSTANCE has marked memory executable\" \"Finding Type : Execution:Runtime/MemoryMarkedExecutable \" \"\""
        },
        {
            "resource": "ecs",
            "tactic": "backdoor",
            "findingType": "Backdoor:Runtime/C&CActivity.B!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - C&C Activity\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": EC2 C&C Activity\" \"Expected Finding: A process is querying a domain name associated with a known Command & Control server.\" \"Finding Type : Backdoor:Runtime/C&CActivity.B!DNS\" \"\"",
            "indicator": "c2.guarddutyc2activityb.com"
        },
        {
            "resource": "ecs",
            "tactic": "crypto",
            "findingType": "CryptoCurrency:Runtime/BitcoinTool.B!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Bitcoin Domain\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": EC2 Bitcoin Tool DNS\" \"Expected Finding: Process curl from EC2 instance \"$RED_TEAM_INSTANCE\" is querying a domain name that is associated with Bitcoin-related activity.\" \"Finding Type : CryptoCurrency:Runtime/BitcoinTool.B!DNS \" \"\"",
            "indicator": "crypto.guarddutyc2activityb.com"
        },
        {
            "resource": "ecs",
            "tactic": "defense-evasion",
            "findingType": "DefenseEvasion:Runtime/ProcessInjection.Ptrace",
            "alias": "runtime/ProcessInjection-Ptrace.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Process Injection Ptrace\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Process Injection Proc\" \"Expected Finding: Process in EC2 instance $RED_TEAM_INSTANCE  has attempted to inject code in process using PTRACE\" \"Finding Type : DefenseEvasion:Runtime/ProcessInjection.Ptrace \" \"\""
        },
        {
            "resource": "ecs",
            "tactic": "defense-evasion",
            "findingType": "DefenseEvasion:Runtime/ProcessInjection.VirtualMemoryWrite",
            "alias": "runtime/ProcessInjection-VirtualMemoryWrite.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Process Injection Virtual Memory Write\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Process Injection VMW\" \"Expected Finding: Process in EC2 instance $RED_TEAM_INSTANCE  has attempted to inject code in process using PROCESS_VM_WRITE\" \"Finding Type : DefenseEvasion:Runtime/ProcessInjection.VirtualMemoryWrite \" \"\""
        },
        {
            "resource": "ecs",
            "tactic": "discovery",
            "findingType": "Discovery:Runtime/RawSocketCreated",
            "alias": "runtime/RawSocketCreated.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Raw Socket Created\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Raw Socket Created\" \"Expected Finding: Process in container has created a raw socket.\" \"Finding Type : Discovery:Runtime/RawSocketCreated \" \"\""
        },
        {
            "resource": "ecs",
            "tactic": "impact",
            "findingType": "Impact:Runtime/AbusedDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Abused Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Abused Domain Reputation\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a low reputation domain that is associated with known abused domains\" \"Finding Type : Impact:Runtime/AbusedDomainRequest.Reputation \" \"\"",
            "indicator": "abused-rep.guarddutyc2activityb.com"
        },
        {
            "resource": "ecs",
            "tactic": "impact",
            "findingType": "Impact:Runtime/BitcoinDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Bitcoin Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Bitcoin Domain Reputation\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a low reputation and is associated with bitcoin mining domains\" \"Finding Type : Impact:Runtime/BitcoinDomainRequest.Reputation \" \"\"",
            "indicator": "crypto-rep.guarddutyc2activityb.com"
        },
        {
            "resource": "ecs",
            "tactic": "impact",
            "findingType": "Impact:Runtime/MaliciousDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Malicious Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Malicious Domain Reputation\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a low reputation domain that is associated with malicious activity\" \"Finding Type : Impact:Runtime/MaliciousDomainRequest.Reputation \" \"\"",
            "indicator": "malicious-rep.guarddutyc2activityb.com"
        },
        {
            "resource": "ecs",
            "tactic": "impact",
            "findingType": "Impact:Runtime/SuspiciousDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Suspicious Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Suspicious Domain Reputation\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a low reputation domain that is suspicious in nature due to its age, low popularity, or similarity to other known malicious domains.\" \"Finding Type : Impact:Runtime/SuspiciousDomainRequest.Reputation \" \"\"",
            "indicator": "suspicious-rep.guarddutyc2activityb.com"
        },
        {
            "resource": "ecs",
            "tactic": "privilege-escalation",
            "findingType": "PrivilegeEscalation:Runtime/ContainerMountsHostDirectory",
            "alias": "runtime/ContainerMountsHostDirectory.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Container Mount Host Directory\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Container Mount Host Directory\" \"Expected Finding: Container has mounted a host directory.\" \"Finding Type : PrivilegeEscalation:Runtime/ContainerMountsHostDirectory \" \"\""
        },
        {
            "resource": "ecs",
            "tactic": "privilege-escalation",
            "findingType": "PrivilegeEscalation:Runtime/DockerSocketAccessed",
            "alias": "runtime/DockerSocketAccessed.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Docker Socket Accessed\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Docker Socket Accessed\" \"Expected Finding: Process in container is communicating with docker socket using unix socket.\" \"Finding Type : PrivilegeEscalation:Runtime/DockerSocketAccessed \" \"\""
        },
        {
            "resource": "ecs",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/BlackholeTraffic!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - BlackholeTraffic Attack\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS BlackholeTraffic DNS\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a blackholed domain name\" \"Finding Type : Trojan:Runtime/BlackholeTraffic!DNS \" \"\"",
            "indicator": "guarddutyblackholeactivity.com"
        },
        {
            "resource": "ecs",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/DGADomainRequest.C!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - DGA Domain Request\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS DGA Domain Request\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying algorithmically generated domains. Such domains are commonly used by malware and could be an indication of a compromised EC2 instance.\" \"Finding Type : Trojan:Runtime/DGADomainRequest.C!DNS \" \"\"",
            "indicator": "guarddutydgaactivity.com"
        },
        {
            "resource": "ecs",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/DriveBySourceTraffic!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - DGA Request\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS DGA\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying algorithmically generated domains. Such domains are commonly used by malware and could be an indication of a compromised EC2 instance.\" \"Finding Type : Trojan:Runtime/DGADomainRequest.C!DNS \" \"\"",
            "indicator": "guarddutydrivebyactivity.com"
        },
        {
            "resource": "ecs",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/DropPoint!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - DropPoint DNS\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS DropPoint DNS\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is querying a domain name of a remote host that is known to hold credentials and other stolen data captured by malware.\" \"Finding Type : Trojan:Runtime/DropPoint!DNS \" \"\"",
            "indicator": "guarddutydroppointactivity.com"
        },
        {
            "resource": "ecs",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/PhishingDomainRequest!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Phishing Domain\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Phishing Domain Request\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE has attempted to communicate with a domain name associated with phishing activities.\" \"Finding Type : Trojan:Runtime/PhishingDomainRequest!DNS \" \"\"",
            "indicator": "guarddutyphishingactivity.com"
        },
        {
            "resource": "ecs",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:Runtime/MaliciousIPCaller.Custom",
            "alias": "threatIntel/request.sh",
            "indicator": "",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Malicious IP Caller\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Malicious IP Caller\" \"Expected Finding: Process curl from EC2 instance $RED_TEAM_INSTANCE is communicating with an IP address $MALICIOUS_IP on your threat list\" \"Finding Type : UnauthorizedAccess:Runtime/MaliciousIPCaller.Custom \" \"\"",
            "port": "8009"
        },
        {
            "resource": "ecs",
            "tactic": "execution",
            "findingType": "Execution:Runtime/ReverseShell",
            "alias": "runtime/ReverseShell.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Reverse Shell\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Reverse Shell\" \"Expected Finding: Process in EC2 instance $RED_TEAM_INSTANCE has created a reverse shell\" \"Finding Type : Execution:Runtime/ReverseShell \" \"\""
        },
        {
            "resource": "ecs",
            "tactic": "execution",
            "findingType": "Execution:Runtime/MemoryMarkedExecutable",
            "alias": "runtime/MemoryMarkedExecutable.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Memory Marked Executable\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Memory Marked Executable\" \"Expected Finding: Process in EC2 instance $RED_TEAM_INSTANCE has marked memory executable\" \"Finding Type : Execution:Runtime/MemoryMarkedExecutable \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "backdoor",
            "findingType": "Backdoor:Runtime/C&CActivity.B!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "indicator": "c2.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - C&C Activity\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": EC2 C&C Activity\" \"Expected Finding: A process is querying a domain name associated with a known Command & Control server.\" \"Finding Type : Backdoor:Runtime/C&CActivity.B!DNS\" \"\""
        },
        {
            "resource": "eks",
            "tactic": "crypto",
            "findingType": "CryptoCurrency:Runtime/BitcoinTool.B!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "indicator": "crypto.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - Bitcoin Domain\"",
            "expectedFinding": "\"Test #\"$TEST_NUM\": EC2 Bitcoin Tool DNS\" \"Expected Finding: Process curl from EC2 instance \"\" is querying a domain name that is associated with Bitcoin-related activity.\" \"Finding Type : CryptoCurrency:Runtime/BitcoinTool.B!DNS \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "defense-evasion",
            "findingType": "DefenseEvasion:Runtime/ProcessInjection.Ptrace",
            "alias": "runtime/ProcessInjection-Ptrace.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Process Injection Ptrace\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Process Injection Proc\" \"Expected Finding: Process in EC2 instance   has attempted to inject code in process using PTRACE\" \"Finding Type : DefenseEvasion:Runtime/ProcessInjection.Ptrace \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "defense-evasion",
            "findingType": "DefenseEvasion:Runtime/ProcessInjection.VirtualMemoryWrite",
            "alias": "runtime/ProcessInjection-VirtualMemoryWrite.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Process Injection Virtual Memory Write\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Process Injection VMW\" \"Expected Finding: Process in EC2 instance   has attempted to inject code in process using PROCESS_VM_WRITE\" \"Finding Type : DefenseEvasion:Runtime/ProcessInjection.VirtualMemoryWrite \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "discovery",
            "findingType": "Discovery:Runtime/RawSocketCreated",
            "alias": "runtime/RawSocketCreated.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Raw Socket Created\"",
            "expectedFinding": "\"Test #$TEST_NUM: ECS Raw Socket Created\" \"Expected Finding: Process in container has created a raw socket.\" \"Finding Type : Discovery:Runtime/RawSocketCreated \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "discovery",
            "findingType": "Discovery:Kubernetes/MaliciousIPCaller.Custom",
            "alias": "eks/DiscoveryMaliciousIPCaller-Custom.sh",
            "logSource": "eks-audit-logs",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Malicious IP getting API Token\"",
            "expectedFinding": "\"Test #$TEST_NUM - Malicious IP getting API Token\" \"Expected Finding: Kubernetes API commonly used in Discovery tactics invoked from an IP address on a custom threat list TesterCustomThreatList.\" \"Finding Type : Discovery:Kubernetes/MaliciousIPCaller.Custom\" \"\""
        },
        {
            "resource": "eks",
            "tactic": "discovery",
            "findingType": "Discovery:Kubernetes/TorIPCaller",
            "alias": "eks/TorIPCaller.sh",
            "logSource": "eks-audit-logs",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - TOR IP calling get API\"",
            "expectedFinding": "\"Test #$TEST_NUM - TOR IP calling get API\" \"Expected Finding: Kubernetes API commonly used in Discovery tactics was invoked on cluster GD-TEST-CLUSTER from Tor exit node IP address\" \"Finding Type : Discovery:Kubernetes/TorIPCaller\" \"\""
        },
        {
            "resource": "eks",
            "tactic": "discovery",
            "findingType": "Discovery:Kubernetes/SuccessfulAnonymousAccess",
            "alias": "eks/SuccessfulAnonymousAccess.sh",
            "logSource": "eks-audit-logs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Successful Anonymous Access\"",
            "expectedFinding": "\"Test #$TEST_NUM - Successful Anonymous Access\" \"Expected Finding: Kubernetes API commonly used in Discovery tactics was invoked on cluster $EKS_CLUSTER_NAME by the anonymous user system:anonymous\" \"Finding Type : Discovery:Kubernetes/SuccessfulAnonymousAccess\" \"\""
        },
        {
            "resource": "eks",
            "tactic": "impact",
            "findingType": "Impact:Runtime/AbusedDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "indicator": "abused-rep.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - Abused Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Abused Domain Reputation\" \"Expected Finding: Process curl from EC2 instance  is querying a low reputation domain that is associated with known abused domains\" \"Finding Type : Impact:Runtime/AbusedDomainRequest.Reputation \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "impact",
            "findingType": "Impact:Runtime/BitcoinDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "indicator": "crypto-rep.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - Bitcoin Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Bitcoin Domain Reputation\" \"Expected Finding: Process curl from EC2 instance  is querying a low reputation and is associated with bitcoin mining domains\" \"Finding Type : Impact:Runtime/BitcoinDomainRequest.Reputation \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "impact",
            "findingType": "Impact:Runtime/MaliciousDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "indicator": "malicious-rep.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - Malicious Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Malicious Domain Reputation\" \"Expected Finding: Process curl from EC2 instance  is querying a low reputation domain that is associated with malicious activity\" \"Finding Type : Impact:Runtime/MaliciousDomainRequest.Reputation \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "impact",
            "findingType": "Impact:Runtime/SuspiciousDomainRequest.Reputation",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "indicator": "suspicious-rep.guarddutyc2activityb.com",
            "description": "echo \"Test #$TEST_NUM - Suspicious Domain Reputation\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Suspicious Domain Reputation\" \"Expected Finding: Process curl from EC2 instance  is querying a low reputation domain that is suspicious in nature due to its age, low popularity, or similarity to other known malicious domains.\" \"Finding Type : Impact:Runtime/SuspiciousDomainRequest.Reputation \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "impact",
            "findingType": "Impact:Kubernetes/MaliciousIPCaller.Custom",
            "alias": "eks/ImpactMaliciousIPCaller-Custom.sh",
            "logSource": "eks-audit-logs",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Create Service Role\"",
            "expectedFinding": "\"Test #$TEST_NUM - Create Service Role\" \"Expected Finding: Kubernetes API commonly used in Impact tactics invoked from an IP address on a custom threat list TesterCustomThreatList.\" \"Finding Type : Impact:Kubernetes/MaliciousIPCaller.Custom\" \"\""
        },
        {
            "resource": "eks",
            "tactic": "persistence",
            "findingType": "Persistence:Kubernetes/ContainerWithSensitiveMount",
            "alias": "eks/ContainerWithSensitiveMount.sh",
            "logSource": "eks-audit-logs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Sensitive Mount\"",
            "expectedFinding": "\"Test #$TEST_NUM - Sensitive Mount\" \"Expected Finding: \" \"Finding Type : Persistence:Kubernetes/ContainerWithSensitiveMount\" \"\""
        },
        {
            "resource": "eks",
            "tactic": "privilege-escalation",
            "findingType": "PrivilegeEscalation:Runtime/ContainerMountsHostDirectory",
            "alias": "runtime/ContainerMountsHostDirectory.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Container Mount Host Directory\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Container Mount Host Directory\" \"Expected Finding: Container has mounted a host directory.\" \"Finding Type : PrivilegeEscalation:Runtime/ContainerMountsHostDirectory \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "privilege-escalation",
            "findingType": "PrivilegeEscalation:Runtime/DockerSocketAccessed",
            "alias": "runtime/DockerSocketAccessed.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Docker Socket Accessed\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Docker Socket Accessed\" \"Expected Finding: Process in container is communicating with docker socket using unix socket.\" \"Finding Type : PrivilegeEscalation:Runtime/DockerSocketAccessed \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "privilege-escalation",
            "findingType": "PrivilegeEscalation:Kubernetes/PrivilegedContainer",
            "alias": "eks/PrivilegedContainer.sh",
            "logSource": "eks-audit-logs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Privileged Container\"",
            "expectedFinding": "\"Test #$TEST_NUM - Privileged Container\" \"Expected Finding: A privileged container with root level access was launched on EKS Cluster $EKS_CLUSTER_NAME. If this behavior is not expected, it may indicate that your credentials are compromised\" \"Finding Type : PrivilegeEscalation:Kubernetes/PrivilegedContainer\" \"\""
        },
        {
            "resource": "eks",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/BlackholeTraffic!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "indicator": "guarddutyblackholeactivity.com",
            "description": "echo \"Test #$TEST_NUM - BlackholeTraffic Attack\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS BlackholeTraffic DNS\" \"Expected Finding: Process curl from EC2 instance  is querying a blackholed domain name\" \"Finding Type : Trojan:Runtime/BlackholeTraffic!DNS \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/DGADomainRequest.C!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "indicator": "guarddutydgaactivity.com",
            "description": "echo \"Test #$TEST_NUM - DGA Domain Request\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS DGA Domain Request\" \"Expected Finding: Process curl from EC2 instance  is querying algorithmically generated domains. Such domains are commonly used by malware and could be an indication of a compromised EC2 instance.\" \"Finding Type : Trojan:Runtime/DGADomainRequest.C!DNS \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/DriveBySourceTraffic!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "indicator": "guarddutydrivebyactivity.com",
            "description": "echo \"Test #$TEST_NUM - DGA Request\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS DGA\" \"Expected Finding: Process curl from EC2 instance  is querying algorithmically generated domains. Such domains are commonly used by malware and could be an indication of a compromised EC2 instance.\" \"Finding Type : Trojan:Runtime/DGADomainRequest.C!DNS \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/DropPoint!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "indicator": "guarddutydroppointactivity.com",
            "description": "echo \"Test #$TEST_NUM - DropPoint DNS\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS DropPoint DNS\" \"Expected Finding: Process curl from EC2 instance  is querying a domain name of a remote host that is known to hold credentials and other stolen data captured by malware.\" \"Finding Type : Trojan:Runtime/DropPoint!DNS \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "trojan",
            "findingType": "Trojan:Runtime/PhishingDomainRequest!DNS",
            "alias": "threatIntel/request.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "indicator": "guarddutyphishingactivity.com",
            "description": "echo \"Test #$TEST_NUM - Phishing Domain\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Phishing Domain Request\" \"Expected Finding: Process curl from EC2 instance  has attempted to communicate with a domain name associated with phishing activities.\" \"Finding Type : Trojan:Runtime/PhishingDomainRequest!DNS \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:Runtime/MaliciousIPCaller.Custom",
            "alias": "threatIntel/request.sh",
            "indicator": "",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Malicious IP Caller\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Malicious IP Caller\" \"Expected Finding: Process curl from EC2 instance  is communicating with an IP address $MALICIOUS_IP on your threat list\" \"Finding Type : UnauthorizedAccess:Runtime/MaliciousIPCaller.Custom \" \"\"",
            "port": "8009"
        },
        {
            "resource": "eks",
            "tactic": "execution",
            "findingType": "Execution:Runtime/ReverseShell",
            "alias": "runtime/ReverseShell.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Reverse Shell\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Reverse Shell\" \"Expected Finding: Process in EC2 instance  has created a reverse shell\" \"Finding Type : Execution:Runtime/ReverseShell \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "execution",
            "findingType": "Execution:Runtime/MemoryMarkedExecutable",
            "alias": "runtime/MemoryMarkedExecutable.sh",
            "logSource": "runtime-monitoring",
            "local": "false",
            "description": "echo \"Test #$TEST_NUM - Memory Marked Executable\"",
            "expectedFinding": "\"Test #$TEST_NUM: EKS Memory Marked Executable\" \"Expected Finding: Process in EC2 instance  has marked memory executable\" \"Finding Type : Execution:Runtime/MemoryMarkedExecutable \" \"\""
        },
        {
            "resource": "eks",
            "tactic": "execution",
            "findingType": "Execution:Kubernetes/ExecInKubeSystemPod",
            "alias": "eks/ExecInKubeSystemPod.sh",
            "logSource": "eks-audit-logs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Command Execution\"",
            "expectedFinding": "\"Test #$TEST_NUM - Command Execution\" \"Expected Finding: A command was executed inside a pod in kube-system namespace on EKS Cluster $EKS_CLUSTER_NAME.\" \"Finding Type : Execution:Kubernetes/ExecInKubeSystemPod\" \"\""
        },
        {
            "resource": "eks",
            "tactic": "policy",
            "findingType": "Policy:Kubernetes/AdminAccessToDefaultServiceAccount",
            "alias": "eks/AdminAccessToDefaultServiceAccount.sh",
            "logSource": "eks-audit-logs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Default Service granted Admin Access\"",
            "expectedFinding": "\"Test #$TEST_NUM - Default Service granted Admin Access\" \"Expected Finding: The default service account in EKS Cluster $EKS_CLUSTER_NAME was granted admin privileges.\" \"Finding Type : Policy:Kubernetes/AdminAccessToDefaultServiceAccount\" \"\""
        },
        {
            "resource": "eks",
            "tactic": "policy",
            "findingType": "Policy:Kubernetes/AnonymousAccessGranted",
            "alias": "eks/AnonymousAccessGranted.sh",
            "logSource": "eks-audit-logs",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - EKS Anonymous Access Granted\"",
            "expectedFinding": "\"Test #$TEST_NUM - EKS Anonymous Access Granted\" \"Expected Finding: The anonymous user system:anonymous was granted API permissions on the EKS cluster $EKS_CLUSTER_NAME.\" \"Finding Type : Policy:Kubernetes/AnonymousAccessGranted\" \"\""
        },
        {
            "resource": "lambda",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:Lambda/MaliciousIPCaller.Custom",
            "alias": "lambda/request.sh",
            "indicator": "",
            "logSource": "lambda",
            "local": "true",
            "description": "echo \"Test #$TEST_NUM - Lambda Custom Malicious Caller\"",
            "expectedFinding": "\"Test #$TEST_NUM: Lambda Custom Malicious Caller\" \"Expected Finding: Lambda function $LAMBDA_NAME is communicating with a disallowed IP address $MALICIOUS_IP on the list TesterCustomThreatList\" \"Finding Type :  UnauthorizedAccess:Lambda/MaliciousIPCaller.Custom\" \"\"",
            "port": "8009"
        },
        {
            "resource": "iam",
            "tactic": "pentest",
            "findingType": "PenTest:IAMUser/KaliLinux",
            "alias": "iam/KaliLinux.sh",
            "description": "echo \"Test #$TEST_NUM - IAM Kali Linux\"",
            "expectedFinding": "\"Test #$TEST_NUM: Kali Linux\" \"Expected Finding: API AssumeRole was invoked from a remote host with IP address $MALICIOUS_IP that is potentially running the Kali Linux penetration testing tool\" \"Finding Type : PenTest:IAMUser/KaliLinux\" \"\"",
            "logSource": "cloudtrail",
            "local": "false"
        },
        {
            "resource": "iam",
            "tactic": "recon",
            "findingType": "Recon:IAMUser/MaliciousIPCaller.Custom",
            "alias": "iam/ReconMaliciousIPCaller-Custom.sh",
            "description": "echo \"Test #$TEST_NUM - Recon Custom Malicious Caller\"",
            "expectedFinding": "\"Test #$TEST_NUM: Recon Custom Malicious Caller\" \"Expected Finding: API ListBuckets, commonly used in reconnaissance attacks, was invoked from an IP address $MALICIOUS_IP on the custom threat list\" \"Finding Type : Recon:IAMUser/MaliciousIPCaller.Custom\" \"\"",
            "logSource": "cloudtrail",
            "local": "false"
        },
        {
            "resource": "iam",
            "tactic": "recon",
            "findingType": "Recon:IAMUser/TorIPCaller",
            "alias": "iam/ReconTorIPCaller.sh",
            "description": "echo \"Test #$TEST_NUM - Anonymous Recon\"",
            "expectedFinding": "\"Test #$TEST_NUM: Anonymous Recon\" \"Expected Finding: API ListBuckets, commonly used in reconnaissance attacks, was invoked from a Tor exit node IP address $IP\" \"Finding Type : Recon:IAMUser/TorIPCaller\" \"\"",
            "logSource": "cloudtrail",
            "local": "false"
        },
        {
            "resource": "iam",
            "tactic": "stealth",
            "findingType": "Stealth:IAMUser/CloudTrailLoggingDisabled",
            "alias": "iam/CloudTrailLoggingDisabled.sh",
            "description": "echo \"Test #$TEST_NUM - Stop Cloud Trail Logging\"",
            "expectedFinding": "\"Test #$TEST_NUM: Stop Cloud Trail Logging\" \"Expected Finding: AWS CloudTrail trail FindingTestTrail was disabled by $ROLE_NAME calling StopLogging under unusual circumstances.\" \"Finding Type : Stealth:IAMUser/CloudTrailLoggingDisabled\" \"\"",
            "logSource": "cloudtrail",
            "local": "true"
        },
        {
            "resource": "iam",
            "tactic": "stealth",
            "findingType": "Stealth:IAMUser/PasswordPolicyChange",
            "alias": "iam/PasswordPolicyChange.sh",
            "description": "echo \"Test #$TEST_NUM - Weaken Account Password Policy\"",
            "expectedFinding": "\"Test #$TEST_NUM: Weaken Account Password Policy\" \"Expected finding: Account password policy was weakened by $ROLE_NAME calling UpdateAccountPasswordPolicy.\" \"Finding Type : Stealth:IAMUser/PasswordPolicyChange\" \"\"",
            "logSource": "cloudtrail",
            "local": "true"
        },
        {
            "resource": "iam",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:IAMUser/TorIPCaller",
            "alias": "iam/InstanceCredentialExfiltration-OutsideAWS.sh",
            "description": "echo \"Test #$TEST_NUM - Log in Attempts with Tor\"",
            "expectedFinding": "\"Test #$TEST_NUM: Log in Attempts with Tor\" \"Expected Finding: API ConsoleLogin was invoked from a Tor exit node IP address\" \"Finding Type : UnauthorizedAccess:IAMUser/TorIPCaller\" \"Expected Finding: Credentials created exclusively for an EC2 instance using instance role $ROLE_NAME have been used from external IP address\" \"Finding Type : UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration.OutsideAWS\" \"\"",
            "logSource": "cloudtrail",
            "local": "false"
        },
        {
            "resource": "iam",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration.OutsideAWS",
            "alias": "iam/InstanceCredentialExfiltration-OutsideAWS.sh",
            "description": "echo \"Test #$TEST_NUM - Log in Attempts with Tor\"",
            "expectedFinding": "\"Test #$TEST_NUM: Log in Attempts with Tor\" \"Expected Finding: API ConsoleLogin was invoked from a Tor exit node IP address\" \"Finding Type : UnauthorizedAccess:IAMUser/TorIPCaller\" \"Expected Finding: Credentials created exclusively for an EC2 instance using instance role $ROLE_NAME have been used from external IP address\" \"Finding Type : UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration.OutsideAWS\" \"\"",
            "logSource": "cloudtrail",
            "local": "false"
        },
        {
            "resource": "iam",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:IAMUser/MaliciousIPCaller.Custom",
            "alias": "iam/UnauthMaliciousIPCaller-Custom.sh",
            "description": "echo \"Test #$TEST_NUM - Custom Malicious Caller\"",
            "expectedFinding": "\"Test #$TEST_NUM: Custom Malicious Caller\" \"Expected Finding: API GetUser was invoked from an IP address on the custom threat list custom\" \"Finding Type :  UnauthorizedAccess:IAMUser/MaliciousIPCaller.Custom\" \"\"",
            "logSource": "cloudtrail",
            "local": "false"
        },
        {
            "resource": "s3",
            "tactic": "discovery",
            "findingType": "Discovery:S3/MaliciousIPCaller.Custom",
            "alias": "s3/DiscoveryMaliciousIPCaller-Custom.sh",
            "description": "echo \"Test #$TEST_NUM Discovery Custom Malicious Caller\"",
            "expectedFinding": "\"Test #$TEST_NUM Discovery Custom Malicious Caller\" \"Expected Finding: An API commonly used in resource discovery was used to access a bucket from an IP address on a custom threat list.\" \"Finding Type : Discovery:S3/MaliciousIPCaller.Custom\" \"\"",
            "local": "false",
            "logSource": "s3-logs"
        },
        {
            "resource": "s3",
            "tactic": "discovery",
            "findingType": "Discovery:S3/TorIPCaller",
            "alias": "s3/DiscoveryTorIPCaller.sh",
            "description": "echo \"Test #$TEST_NUM - Anonymous Resource Discovery\"",
            "expectedFinding": "\"Test #$TEST_NUM - Anonymous Resource Discovery\" \"Expected Finding: An API commonly used in resource discovery was used to access a bucket from a Tor exit node IP address.\" \"Finding Type : Discovery:S3/TorIPCaller\" \"\"",
            "local": "false",
            "logSource": "s3-logs"
        },
        {
            "resource": "s3",
            "tactic": "pentest",
            "findingType": "PenTest:S3/KaliLinux",
            "alias": "s3/KaliLinux.sh",
            "description": "echo \"Test #$TEST_NUM - Pentest Resource Discovery\"",
            "expectedFinding": "\"Test #$TEST_NUM - Pentest Resource Discovery\" \"Expected Finding: An API was used to access an S3 Bucket from a remote host that is potentially running the Kali Linux penetration testing tool.\" \"Finding Type : PenTest:S3/KaliLinux\" \"\"",
            "local": "false",
            "logSource": "s3-logs"
        },
        {
            "resource": "s3",
            "tactic": "policy",
            "findingType": "Policy:S3/AccountBlockPublicAccessDisabled",
            "alias": "s3/AccountBlockPublicAccessDisabled.sh",
            "description": "echo \"Test #$TEST_NUM - Public Access Blocking Turned off at Account Level\"",
            "expectedFinding": "\"Test #$TEST_NUM - Public Access Blocking Turned off at Account Level\" \"Expected Finding: Amazon S3 Block Public Access was disabled for account $ACCNT_ID by $ROLE_NAME by calling PutAccountPublicAccessBlock\" \"Finding Type : Policy:S3/AccountBlockPublicAccessDisabled\" \"\"",
            "local": "true",
            "logSource": "cloudtrail"
        },
        {
            "resource": "s3",
            "tactic": "policy",
            "findingType": "Policy:S3/BucketBlockPublicAccessDisabled",
            "alias": "s3/BucketBlockPublicAccessDisabled.sh",
            "description": "echo \"Test #$TEST_NUM - Public Access Blocking Turned off at Bucket Level\"",
            "expectedFinding": "\"Test #$TEST_NUM - Public Access Blocking Turned off at Bucket Level\" \"Expected Finding: Amazon S3 Block Public Access was disabled for account $ACCNT_ID by $ROLE_NAME by calling PutBucketPublicAccessBlock\" \"Finding Type : Policy:S3/BucketBlockPublicAccessDisabled\" \"\"",
            "local": "true",
            "logSource": "cloudtrail"
        },
        {
            "resource": "s3",
            "tactic": "policy",
            "findingType": "Policy:S3/BucketPublicAccessGranted",
            "alias": "s3/BucketPublicAccessGranted.sh",
            "description": "echo \"Test #$TEST_NUM - Make Bucket Public\"",
            "expectedFinding": "\"Test #$TEST_NUM - Make Bucket Public\" \"Expected Finding: The Amazon S3 bucket $S3_BUCKET_NAME was granted public access by $ROLE_NAME calling PutBucketAcl\" \"Finding Type : Policy:S3/BucketPublicAccessGranted\" \"\"",
            "local": "true",
            "logSource": "cloudtrail"
        },
        {
            "resource": "s3",
            "tactic": "policy",
            "findingType": "Policy:S3/BucketAnonymousAccessGranted",
            "alias": "s3/BucketAnonymousAccessGranted.sh",
            "description": "echo \"Test #$TEST_NUM - Make Bucket Anonymous\"",
            "expectedFinding": "\"Test #$TEST_NUM - Make Bucket Anonymous\" \"Expected Finding: The Amazon S3 bucket $S3_BUCKET_NAME was granted public anonymous access by $ROLE_NAME calling PutBucketAcl\" \"Finding Type : Policy:S3/BucketAnonymousAccessGranted\" \"\"",
            "local": "true",
            "logSource": "cloudtrail"
        },
        {
            "resource": "s3",
            "tactic": "stealth",
            "findingType": "Stealth:S3/ServerAccessLoggingDisabled",
            "alias": "s3/ServerAccessLoggingDisabled.sh",
            "description": "",
            "expectedFinding": "",
            "local": "true",
            "logSource": "cloudtrail"
        },
        {
            "resource": "s3",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:S3/MaliciousIPCaller.Custom",
            "alias": "s3/UnauthMaliciousIPCaller-Custom.sh",
            "description": "echo \"Test #$TEST_NUM - Custom Malicious IP Resource Collection\"",
            "expectedFinding": "\"Test #$TEST_NUM - Custom Malicious IP Resource Collection\" \"Expected Finding: An API was used to access a bucket from an IP address on a custom threat list.\" \"Finding Type : UnauthorizedAccess:S3/MaliciousIPCaller.Custom\" \"\"",
            "local": "false",
            "logSource": "s3-logs"
        },
        {
            "resource": "s3",
            "tactic": "unauthorized-access",
            "findingType": "UnauthorizedAccess:S3/TorIPCaller",
            "alias": "s3/UnauthTorIPCaller.sh",
            "description": "echo \"Test #$TEST_NUM - Anonymous Resource Collection\"",
            "expectedFinding": "\"Test #$TEST_NUM - Anonymous Resource Collection\" \"Expected Finding: An API was used to access a bucket from a Tor exit node IP address.\" \"Finding Type : UnauthorizedAccess:S3/TorIPCaller\" \"\"",
            "local": "false",
            "logSource": "s3-logs"
        }
    ]
}